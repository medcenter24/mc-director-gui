<div class="row" *ngIf="isLoaded">
  <div class="col-sm-3">
    <div class="row">
      <div class="col-12 mb-2">
        <label class="label required separate" for="title" translate>Type</label>
        <p-selectButton [options]="financeTypes"
                        [(ngModel)]="selectedFinanceTypeId"
                        (onChange)="onFinanceTypeChanged($event)"></p-selectButton>
      </div>
    </div>
    <div class="row">
      <div class="col-12 mb-2">
        <label class="label required separate" for="title" translate>Title</label>
        <input type="text" pInputText
               id="title"
               [(value)]="rule.title"
               size="30"
               (input)="onTitleChanged($event)"
               required/>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label separate" translate>Doctor</label>
        <nga-multi-selector
          [service]="doctorService"
          placeholder="Doctors"
          labelField="name"
          (init)="startLoader($event)"
          (loaded)="stopLoader($event)"
          (selected)="onDoctorsChanged($event)"
          [preloadedData]="rule.doctors"
        ></nga-multi-selector>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label separate" translate>Assistant</label>
        <nga-multi-selector
          [service]="assistantService"
          placeholder="Assistants"
          labelField="title"
          (init)="startLoader($event)"
          (loaded)="stopLoader($event)"
          (selected)="onAssistantsChanged($event)"
          [preloadedData]="rule.assistants"
        ></nga-multi-selector>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label separate" translate>City</label>
        <nga-multi-selector
          [service]="cityService"
          placeholder="Cities"
          labelField="title"
          (init)="startLoader($event)"
          (loaded)="stopLoader($event)"
          (selected)="onCitiesChanged($event)"
          [preloadedData]="rule.cities"
        ></nga-multi-selector>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label separate" translate>Date Period</label>
        <nga-multi-selector
          [service]="periodService"
          placeholder="Date Periods"
          labelField="title"
          (init)="startLoader($event)"
          (loaded)="stopLoader($event)"
          (selected)="onPeriodsChanged($event)"
          [preloadedData]="rule.datePeriods"
        ></nga-multi-selector>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label separate" translate>Services</label>
        <nga-multi-selector
          [service]="servicesService"
          placeholder="Services"
          labelField="title"
          (init)="startLoader($event)"
          (loaded)="stopLoader($event)"
          (selected)="onServicesChanged($event)"
          [preloadedData]="rule.services"
        ></nga-multi-selector>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label required separate" for="price"><b translate>Set Amount</b></label>
        <input type="text" pInputText
               id="price"
               [(value)]="rule.priceAmount"
               size="30"
               (input)="onPriceAmountChanged($event)"
               (change)="priceAmountToFixed($event)"
               required/>
      </div>
    </div>

    <div class="row">
      <div class="col-12 mb-2">
        <label class="label required separate" for="price">{{ 'Currency' | translate }}</label>
        <div class="row">
          <div class="col-12">
            <p-inputSwitch [(ngModel)]="rule.isPercent"></p-inputSwitch>
          </div>
        </div>
        <div class="row">
          <div class="col-12">
            <nga-autocompleter
                    *ngIf="!rule.isPercent"
                    [service]="currencyService"
                    placeholder="Choose Currency"
                    labelField="title"
                    (selected)="setCurrency($event)"
                    [preloadedData]="rule.currencyId"
                    (init)="startLoader($event)"
                    (loaded)="stopLoader($event)"
            ></nga-autocompleter>
          </div>
        </div>
      </div>
    </div>

    <button class="btn btn-success"
            [disabled]="!hasPrice()"
            (click)="saveFinanceRule()"
            translate
    >{{ rule.id ? 'Update' : 'Add' }}</button>
  </div>
  <div class="col-sm-9">
    <div class="alert alert-warning" role="alert">
      <nga-finance-info
        [(financeRule)]="rule"
        (init)="startLoader($event)"
        (loaded)="stopLoader($event)"
      ></nga-finance-info>
    </div>
  </div>
</div>
